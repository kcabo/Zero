<!DOCTYPE html>
<html lang="ja">

<head>
  <title>SwimmersZero</title>
  <meta charset="utf-8">
  <meta name="description" content="水泳選手の記録の分析を数百万の大会結果から出力します。">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content="#ffffff">
  <link rel="icon" type="image/png" href="static/img/icon-192x192.png">
  <link rel="apple-touch-icon" type="image/png" href="static/img/apple-touch-icon-180x180.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://unpkg.com/ress/dist/ress.min.css">
  <link rel="stylesheet" href="static/css/common.css">
  <link rel="stylesheet" href="static/css/dashboard.css">
</head>

<body>
  <nav>
    <a href="/"><img src="static/img/wlogo.svg" alt="Zero" id="logo"></a>
    <form id="search-container" method="post" action="/dashboard">
      <!-- とりあえず今はidでのみ検索できるように -->
      <input name="id" type="text" placeholder="選手を検索">
      <input type="submit" value=""><span></span>
    </form>
  </nav>

  <div id="swimmer-info">
    <img src="static/img/{{s.sex}}.svg" alt="{{s.sex}}" id="p-icon">
    <div class="column">
      <h1>{{s.name}}</h1>
      <div id="tips">
        <span class="univ">{{s.grade}}</span>
        {% for t in s.teams %}
        <span>{{t}}</span>
        {% endfor %}
      </div>
    </div>
  </div>


  <div class="cards">
    <div id="participate">
      <div id="radar-container" class="card">
        <canvas id="radar" width="400" height="400"></canvas>
      </div>
      <div class="column">
        <div class="card">
          <p class="caption">出場回数</p>
          <p class="data">{{s.total_count}}<span>回</span></p>
        </div>
        <div class="card">
          <p class="caption">S1種目</p>
          <p class="data">{{s.s1}}</p>
        </div>
        <div class="card">
          <p class="caption">S1偏差値(長)</p>
          <p class="data">61.7</p>
        </div>
        <div class="card">
          <p class="caption">S1偏差値(短)</p>
          <p class="data">59.0</p>
        </div>
      </div>
    </div>

    <div id="condition" class="card">
      <h2>2019年の調子</h2>
      <p>○…長水路 △…短水路</p>
      <div id="line-container">
        <canvas id="lineChart" width="400" height="250"></canvas>
      </div>
    </div>
  </div>

  <div class="caption-container">
    <div class="circle"></div>
    <h3>Bests</h3>
  </div>
  <div id="bests">
    {% if s.Fr_sprint_bests %}
    <div class="card">
      <div class="header Fr">
        <img src="static/img/Fr.svg" alt="自由形">
        <p>自由形</p>
      </div>
      <div class="best_container">
        <table>
          <thead>
            <tr><td><span>短</span></td><td></td><td><span>長</span></td></tr>
          </thead>
          <tbody>
            <tr><td>{{s.Fr_sprint_bests['s-50Fr'][0]}}</td><th rowspan="2"><span>50m</span></th><td>{{s.Fr_sprint_bests['l-50Fr'][0]}}</td></tr>
            <tr><td>{{s.Fr_sprint_bests['s-50Fr'][1]}}</td><td>{{s.Fr_sprint_bests['l-50Fr'][1]}}</td></tr>
            <tr><td>{{s.Fr_sprint_bests['s-100Fr'][0]}}</td><th rowspan="2"><span>100m</span></th><td>{{s.Fr_sprint_bests['l-100Fr'][0]}}</td></tr>
            <tr><td>{{s.Fr_sprint_bests['s-100Fr'][1]}}</td><td>{{s.Fr_sprint_bests['l-100Fr'][1]}}</td></tr>
            <tr><td>{{s.Fr_sprint_bests['s-200Fr'][0]}}</td><th rowspan="2"><span>200m</span></th><td>{{s.Fr_sprint_bests['l-200Fr'][0]}}</td></tr>
            <tr><td>{{s.Fr_sprint_bests['s-200Fr'][1]}}</td><td>{{s.Fr_sprint_bests['l-200Fr'][1]}}</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}
    {% if s.Fr_endurance_bests %}
    <div class="card">
      <div class="header Fr">
        <img src="static/img/Fr.svg" alt="自由形">
        <p>自由形</p>
      </div>
      <div class="best_container">
        <table>
          <thead>
            <tr><td><span>短</span></td><td></td><td><span>長</span></td></tr>
          </thead>
          <tbody>
            <tr><td>{{s.Fr_endurance_bests['s-400Fr'][0]}}</td><th rowspan="2"><span>400m</span></th><td>{{s.Fr_endurance_bests['l-400Fr'][0]}}</td></tr>
            <tr><td>{{s.Fr_endurance_bests['s-400Fr'][1]}}</td><td>{{s.Fr_endurance_bests['l-400Fr'][1]}}</td></tr>
            <tr><td>{{s.Fr_endurance_bests['s-800Fr'][0]}}</td><th rowspan="2"><span>800m</span></th><td>{{s.Fr_endurance_bests['l-800Fr'][0]}}</td></tr>
            <tr><td>{{s.Fr_endurance_bests['s-800Fr'][1]}}</td><td>{{s.Fr_endurance_bests['l-800Fr'][1]}}</td></tr>
            <tr><td>{{s.Fr_endurance_bests['s-1500Fr'][0]}}</td><th rowspan="2"><span>1500m</span></th><td>{{s.Fr_endurance_bests['l-1500Fr'][0]}}</td></tr>
            <tr><td>{{s.Fr_endurance_bests['s-1500Fr'][1]}}</td><td>{{s.Fr_endurance_bests['l-1500Fr'][1]}}</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}
    {% if s.Ba_bests %}
    <div class="card">
      <div class="header Ba">
        <img src="static/img/Ba.svg" alt="背泳ぎ">
        <p>背泳ぎ</p>
      </div>
      <div class="best_container">
        <table>
          <thead>
            <tr><td><span>短</span></td><td></td><td><span>長</span></td></tr>
          </thead>
          <tbody>
            <tr><td>{{s.Ba_bests['s-50Ba'][0]}}</td><th rowspan="2"><span>50m</span></th><td>{{s.Ba_bests['l-50Ba'][0]}}</td></tr>
            <tr><td>{{s.Ba_bests['s-50Ba'][1]}}</td><td>{{s.Ba_bests['l-50Ba'][1]}}</td></tr>
            <tr><td>{{s.Ba_bests['s-100Ba'][0]}}</td><th rowspan="2"><span>100m</span></th><td>{{s.Ba_bests['l-100Ba'][0]}}</td></tr>
            <tr><td>{{s.Ba_bests['s-100Ba'][1]}}</td><td>{{s.Ba_bests['l-100Ba'][1]}}</td></tr>
            <tr><td>{{s.Ba_bests['s-200Ba'][0]}}</td><th rowspan="2"><span>200m</span></th><td>{{s.Ba_bests['l-200Ba'][0]}}</td></tr>
            <tr><td>{{s.Ba_bests['s-200Ba'][1]}}</td><td>{{s.Ba_bests['l-200Ba'][1]}}</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}
    {% if s.Br_bests %}
    <div class="card">
      <div class="header Br">
        <img src="static/img/Br.svg" alt="平泳ぎ">
        <p>平泳ぎ</p>
      </div>
      <div class="best_container">
        <table>
          <thead>
            <tr><td><span>短</span></td><td></td><td><span>長</span></td></tr>
          </thead>
          <tbody>
            <tr><td>{{s.Br_bests['s-50Br'][0]}}</td><th rowspan="2"><span>50m</span></th><td>{{s.Br_bests['l-50Br'][0]}}</td></tr>
            <tr><td>{{s.Br_bests['s-50Br'][1]}}</td><td>{{s.Br_bests['l-50Br'][1]}}</td></tr>
            <tr><td>{{s.Br_bests['s-100Br'][0]}}</td><th rowspan="2"><span>100m</span></th><td>{{s.Br_bests['l-100Br'][0]}}</td></tr>
            <tr><td>{{s.Br_bests['s-100Br'][1]}}</td><td>{{s.Br_bests['l-100Br'][1]}}</td></tr>
            <tr><td>{{s.Br_bests['s-200Br'][0]}}</td><th rowspan="2"><span>200m</span></th><td>{{s.Br_bests['l-200Br'][0]}}</td></tr>
            <tr><td>{{s.Br_bests['s-200Br'][1]}}</td><td>{{s.Br_bests['l-200Br'][1]}}</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}
    {% if s.Fly_bests %}
    <div class="card">
      <div class="header Fly">
        <img src="static/img/Fly.svg" alt="バタフライ">
        <p>バタフライ</p>
      </div>
      <div class="best_container">
        <table>
          <thead>
            <tr><td><span>短</span></td><td></td><td><span>長</span></td></tr>
          </thead>
          <tbody>
            <tr><td>{{s.Fly_bests['s-50Fly'][0]}}</td><th rowspan="2"><span>50m</span></th><td>{{s.Fly_bests['l-50Fly'][0]}}</td></tr>
            <tr><td>{{s.Fly_bests['s-50Fly'][1]}}</td><td>{{s.Fly_bests['l-50Fly'][1]}}</td></tr>
            <tr><td>{{s.Fly_bests['s-100Fly'][0]}}</td><th rowspan="2"><span>100m</span></th><td>{{s.Fly_bests['l-100Fly'][0]}}</td></tr>
            <tr><td>{{s.Fly_bests['s-100Fly'][1]}}</td><td>{{s.Fly_bests['l-100Fly'][1]}}</td></tr>
            <tr><td>{{s.Fly_bests['s-200Fly'][0]}}</td><th rowspan="2"><span>200m</span></th><td>{{s.Fly_bests['l-200Fly'][0]}}</td></tr>
            <tr><td>{{s.Fly_bests['s-200Fly'][1]}}</td><td>{{s.Fly_bests['l-200Fly'][1]}}</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}
    {% if s.IM_bests %}
    <div class="card">
      <div class="header IM">
        <img src="static/img/IM.svg" alt="個人メドレー">
        <p>個人メドレー</p>
      </div>
      <div class="best_container">
        <table>
          <thead>
            <tr><td><span>短</span></td><td></td><td><span>長</span></td></tr>
          </thead>
          <tbody>
            <tr><td>{{s.IM_bests['s-100IM'][0]}}</td><th rowspan="2"><span>100m</span></th><td>{{s.IM_bests['l-100IM'][0]}}</td></tr>
            <tr><td>{{s.IM_bests['s-100IM'][1]}}</td><td>{{s.IM_bests['l-100IM'][1]}}</td></tr>
            <tr><td>{{s.IM_bests['s-200IM'][0]}}</td><th rowspan="2"><span>200m</span></th><td>{{s.IM_bests['l-200IM'][0]}}</td></tr>
            <tr><td>{{s.IM_bests['s-200IM'][1]}}</td><td>{{s.IM_bests['l-200IM'][1]}}</td></tr>
            <tr><td>{{s.IM_bests['s-400IM'][0]}}</td><th rowspan="2"><span>400m</span></th><td>{{s.IM_bests['l-400IM'][0]}}</td></tr>
            <tr><td>{{s.IM_bests['s-400IM'][1]}}</td><td>{{s.IM_bests['l-400IM'][1]}}</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}

    <div class="card">
      <div class="header Ba">
        <img src="static/img/Ba.svg" alt="背泳ぎ">
        <p>背泳ぎ</p>
      </div>
      <div class="best_container">
        <table>
          <thead>
            <tr>
              <td><span>短</span></td>
              <td></td>
              <td><span>長</span></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>0:28.12</td>
              <th rowspan="2"><span>50m</span></th>
              <td>0:29.12</td>
            </tr>
            <tr>
              <td>2019/03/17</td>
              <td>2019/03/17</td>
            </tr>
            <tr>
              <td>0:28.12</td>
              <th rowspan="2"><span>100m</span></th>
              <td>0:29.12</td>
            </tr>
            <tr>
              <td>2019/03/17</td>
              <td>2019/03/17</td>
            </tr>
            <tr>
              <td>0:28.12</td>
              <th rowspan="2"><span>200m</span></th>
              <td>0:29.12</td>
            </tr>
            <tr>
              <td>2019/03/17</td>
              <td>2019/03/17</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>


  <div class="caption-container">
    <div class="circle"></div>
    <h3>Records</h3>
  </div>

  <div id="records" class="card">
    <table>
      <tbody>
        {% for r in s.records.itertuples() %}
        <tr>
          <td><span class="{{r.style}}">{{r.event}}</span></td>
          <td>{{r.time}}</td>
          <td><span class="{{r.pool}}">{% if r.pool == 'l' %}長{% else %}短{% endif %}</span></td>
          <td>{{r.start}}<br>{{r.meet_name}}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>





  <svg class="editorial" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none">
    <defs>
      <path id="gentle-wave" d="M-160 44c30 0
      58-18 88-18s
      58 18 88 18
      58-18 88-18
      58 18 88 18
      v44h-352z" />
    </defs>
    <g class="parallax">
      <use xlink:href="#gentle-wave" x="50" y="0" fill="#4579e2" />
      <use xlink:href="#gentle-wave" x="50" y="3" fill="#3461c1" />
      <use xlink:href="#gentle-wave" x="50" y="6" fill="#2d55aa" />
    </g>
  </svg>
  <div id="footer">
    <p>Created by Reo Kanzaki</p>
  </div>


  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  <script>
    var colorLong = '#1B98E0';
    var colorShort = '#06A77D';
    var tDegree = '29'
    var gray = '#555';
    var lineWidth = 0.7;

    var ctxRadar = document.getElementById("radar").getContext('2d');
    var dataLong = {{s.count_style_long}};
    var dataShort = {{s.count_style_short}};
    var radarConfig = {
      type: 'radar',
      data: {
        labels: ['Fr', 'Ba', 'Br', 'Fly', 'IM'],
        datasets: [{
          data: dataLong,
          label: '長水',
          borderColor: colorLong,
          pointBorderColor: colorLong,
          backgroundColor: colorLong + tDegree,
          pointBackgroundColor: colorLong + tDegree,
          borderWidth: lineWidth,
          pointBorderWidth: lineWidth
        }, {
          data: dataShort,
          label: '短水',
          borderColor: colorShort,
          pointBorderColor: colorShort,
          backgroundColor: colorShort + tDegree,
          pointBackgroundColor: colorShort + tDegree,
          borderWidth: lineWidth,
          pointBorderWidth: lineWidth
        }]
      },
      options: {
        legend: {
          display: true,
          position: 'bottom',
          labels: {
            fontSize: 10
          }
        },
        scale: {
          pointLabels: {
            fontSize: 10,
            fontColor: gray,
          },
          ticks: {
            fontColor: gray,
            suggestedMin: 0,
            max: 15,
            stepSize: 5,
          },
          gridLines: {
            color: gray,
            lineWidth: 0.5
          },
          angleLines: {
            color: gray,
            lineWidth: 0.5
          }
        }
      }
    };
    var radar = new Chart(ctxRadar, radarConfig);

    var jMonths = ['4', '5', '6', '7', '8', '9', '10', '11', '12', '1', '2', '3', '4'];
    var colorE1 = '#CD6CFF';
    var colorE2 = '#F4376E';
    var ctxLine = document.getElementById("lineChart").getContext('2d');
    var e1Long = [{{s.e1_long_points}}];
    var e1Short = [{{s.e1_short_points}}];
    var e2Long = [{{s.e2_long_points}}];
    var e2Short = [{{s.e2_short_points}}];
    var datasets = [{
        label: '長水路 {{s.s1}}',
        data: e1Long,
        pointStyle: 'circle',
        borderColor: colorE1,
        backgroundColor: colorE1 + tDegree,
        showLine: true,
        borderWidth: lineWidth,
      },
      {
        label: '短水路 {{s.s1}}',
        data: e1Short,
        pointStyle: 'triangle',
        borderColor: colorE1,
        backgroundColor: colorE1 + tDegree,
        showLine: true,
        borderWidth: lineWidth,
      },
      {
        label: '長水路 {{s.s2}}',
        data: e2Long,
        pointStyle: 'circle',
        borderColor: colorE2,
        backgroundColor: colorE2 + tDegree,
        showLine: true,
        borderWidth: lineWidth,
      },
      {
        label: '短水路 {{s.s2}}',
        data: e2Short,
        pointStyle: 'triangle',
        borderColor: colorE2,
        backgroundColor: colorE2 + tDegree,
        showLine: true,
        borderWidth: lineWidth,
      }
    ];

    var lineConfig = {
      type: 'scatter',
      data: {
        datasets: datasets
      },
      options: {
        // tooltips: {
        //   enabled: false
        // },
        elements: {
          line: {
            tension: 0
          },
        },
        legend: {
          position: 'bottom',
        },
        scales: {
          xAxes: [{
            ticks: {
              suggestedMin: 0,
              suggestedMax: 365,
              stepSize: 1,
              autoSkip: false,
              maxRotation: 0,
              callback: function(value, index, values) {
                // 4月1日からの経過日数リスト。これらは各月の一日目。個人的に最高にイカしてる実装方法
                var i = [0, 30, 61, 91, 122, 153, 183, 214, 244, 275, 306, 335, 365].indexOf(value);
                if (i >= 0) {
                  return jMonths[i]
                } else {
                  return null
                }
              }
            },
            gridLines: {
              borderDash: [3],
              zeroLineBorderDash: [3],
              tickMarkLength: 8,
              color: '#aaa',
              zeroLineColor: '#aaa',
              lineWidth: 0.5,
              zeroLineWidth: 0.5,
            }
          }],
          yAxes: [{
            display: false,
            ticks: {
              suggestedMin: 0,
              suggestedMax: 105,
              stepSize: 1,
            }
          }]
        }
      }
    };
    var myChart = new Chart(ctxLine, lineConfig);
  </script>
</body>

</html>
